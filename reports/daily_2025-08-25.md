# ุชูุฑูุฑ ูููู ููููุงู ุงูููุฌุฒุฉ โ 25 ุฃุบุณุทุณ 2025

**Project:** Tree Species Classification โ TRAITEMENT DES DONNEES MULTIMEDIA
**ููุฌุฒ:** ูุงุฏ ุงูููู ููุฌูู ูุนูุงุฏ ุจุงุด ูุนุฑู ุดูู ุชุฏุงุฑ ุงูููู ูุงููุดุฑูุนุ ุดูู ุงููุฎุฑุฌุงุชุ ูุดูู ุงูุฎุทูุงุช ุงููู ุฎุงุตูุง ูุฏูุฑู ูู ุจุนุฏ. ูููุชุจ ุจุงูุฏุงุฑุฌุฉ ุงูุนุฑุจูุฉ ูุงููุตุทูุญุงุช ุงูุนูููุฉ ุจุงููุฑุงูุณุงูู/ุงูุฅูุฌููุฒูุฉ ุจูู ููุณูู ุจุงุด ุชููู ูุงุถุญุฉ.

---

## 1) ุดูู ุฎูุฏููุง ุงูููู (Summary)

ุงูููู ููููุง ุฌูุฌ ููุงู ูููููู ูู ุงูุฎุทุฉ:

* **A1 โ Preprocessing core (`prepare_all.py`)**

  * **ุงููุตู:** ุณูุฑูุจุช ูููุฑุฃ raw point clouds (`.ply`, `.pcd`, `.xyz`, `.txt`, `.npy`)ุ ูุฏูุฑ cleaning (statistical outlier removal โ *SOR*), centeringุ scaling (unit sphere)ุ ูุญุณุจ normalsุ ููู ุจุนุฏ ูุทุจู FPS (Farthest Point Sampling) ุจุงุด ูุงุฎุฐ **N = 1024** ููุงุท ููู ุดุฌุฑุฉ.
  * **ูุฎุฑุฌุงุช (Outputs):**

    * `preprocessing/data/processed/sampled/<id>.npy`  โ (Nร3, `float32`)
    * `preprocessing/data/processed/normals/<id>.npy`  โ (Nร3, `float32`)
    * `preprocessing/data/processed/manifest.csv` (columns: `id, status, sampled_path, normals_path, raw_path, notes`)
  * **ุฎูุงุฑุงุช CLI ุงููู ุฏุฎููู:** `--raw_dir`, `--out_dir`, `--npoints`, `--workers`, `--fast`, `--overwrite`, `--seed`, `--verbose`.
  * **ููุงุญุธุงุช ุชูููุฐูุฉ:** ุฏูุฑ small-unit tests ุนูู couple ุฏูุงู ุงููููุงุช ูุจู full-run. ุงูุณูุฑูุจุช ููู deterministic FPS fallback (numpy) ูfallback ูููOpen3D ุฅูุง ูุงูุงูุด ูุชููุฑ.

* **A2 โ Quick EDA (`eda.py`)**

  * **ุงููุตู:** ุณูุฑูุจุช EDA ููุนุงูุฏ ูุดููู ุงูุฏุงุชุง ููุนุทููุง ุฅุญุตุงุฆูุงุช per-classุ distribution ุฏูุงู ุนุฏุฏ ุงูููุงุทุ ูููุตููุฑ preview images ููู ุตูู.
  * **ูุฎุฑุฌุงุช (Outputs):**

    * `reports/eda_summary.md` (ููุฎูุต ุจุงููุงุฑูุฏุงูู)
    * `reports/point_counts_per_file.csv`
    * `reports/class_counts.csv`
    * `reports/plots/point_count_histogram.png`
    * `reports/plots/class_balance_bar.png`
    * `reports/plots/points_boxplot_per_class.png`
    * `reports/sample_images/<class>_<id>_preview.png` (ุตูุฑ ูุนุงููุฉ)
    * `reports/EDA_notebook.ipynb` ู `reports/index.html` (interactive Jupyter notebook ูHTML export) โ ุฏุฑูุงู ุจุงุด ูุณูู ุงูุนุฑุถ.

---

## 2) ููู ูุฎุฒููู ุงููุฎุฑุฌุงุช ุงูุขู (Current filesystem snapshot)

```
D:.
โโโโpreprocessing
    โโโโdata
        โโโโprocessed
            โโโโnormals
            โโโโsampled
โโโโreports
    โ   class_counts.csv
    โ   EDA_notebook.ipynb
    โ   eda_summary.md
    โ   index.html
    โ   point_counts_per_file.csv
    โโโโplots
    โ       class_balance_bar.png
    โ       points_boxplot_per_class.png
    โ       point_count_histogram.png
    โโโโsample_images
            Buche_Buche_18_preview.png
            ... (ุตูุฑ ููู class ุญุณุจ ุงู-preview)
```

---

## 3) ุฃููุฑ ุชููููุฉ ููููุฉ ุงููู ุฏุฑุช/ุถุจุทุช ุงูููู

* **Determinism:** ุถุจุทูุง `seed` (Python, NumPy) ุจุงุด ูููู reproducible.
* **FPS:** ุชูููุฐ FPS (Farthest Point Sampling) ูุน fallback numpy deterministic ุจุงุด ูุถูู N=1024 ููู ุนูููุฉุ ุฅุฐุง ูุงู ุนุฏุฏ ุงูููุงุท ุงูุฃุตูู ุฃูู ูู 1024ุ ุงูุณูุฑูุจุช ููุฒูุฏ ููุงุฐุฌ ูู indices ุจุทุฑููุฉ determinisitic (repeat+shuffle ูุน seed).
* **Outlier removal:** ุงุณุชุนูููุง Statistical Outlier Removal (Open3D ุฅุฐุง ููุฌูุฏุ ูุฅูุง fallback ุจุฏูู SOR). ุงูููู ุงูุงูุชุฑุงุถูุฉ: `nb_neighbors=20, std_ratio=2.0`.
* **Normals:** ุงุณุชุนูููุง Open3D `estimate_normals` ูุน `k=16`ุ ุฅูุง ูุดููุง ุฑุฌูุนูุง zero-normals ูุน logging.
* **EDA rendering:** ุตูุฑ ุงููpreview ููููุฏุฉ ุจุทุฑู ุขููุฉ โ ุฅุฐุง Open3D offscreen ูุงูุงูุด ูุชููุฑุ ุงุณุชุนูููุง matplotlib 3-projection collage (XY, XZ, YZ).
* **Markdown report + Notebook:** ุตุฏูุฑุช `reports/index.html` ูู `reports/EDA_notebook.ipynb` ุจุงุด ููุฏุฑ ูุจุนุช ุตูุญุฉ ุซุงุจุชุฉ ููุนุฑุถ.

---

## 4) ูุชุงุฆุฌ ุณุฑูุนุฉ ูู EDA (ุงููู ููููุงู ูุฎุตููุง ูุนุฑูู)

* **Flagged small classes (< 30 samples):**

  * `Eiche` (Oak)
  * `Kiefer` (Pine)
    ูุงุฏ ุงูุดู ูุทููุจ ูุฃุฎุฏูู ุจุนูู ุงูุงุนุชุจุงุฑ ูุงุญูุงู (oversample ุฃู class weights).
* **Tiny clouds (<10 pts):** ูุงูุงููุด (No major issues detected).
* **ููุงุท ููู ููู:** ูู `n_points = 1024` โ ูุนูู A1 ุฏุงุฑ FPS ูุฒูุงู.
* **ุตูุฑ ุงููุนุงููุฉ:** ุฑุงุฌุนูู ุจุตุฑูุงู ุญูุซ Hu Moments ุญุณุงุณูุฉ ูููrender (camera, scale, background). ุฎุงุตูุง ูุชุฃูุฏู ุฃู ุงูrender settings ููุญูุฏุฉ ุจุงุด ุงููHu Moments ุชููู ูุณุชูุฑุฉ.

---

## 5) ุงูุฃูุงูุฑ ุงููู ุงุณุชุนูููุง/ููุฏุฑู ูุณุชุนููู ุฏุงุจุง (Usage)

* **ุชุดุบูู preprocessing (debug/fast):**

```bash
python prepare_all.py --raw_dir "Dataset/dataverse_files" --out_dir preprocessing/data/processed --npoints 1024 --fast --workers 2
```

* **ุชุดุบูู full preprocessing:**

```bash
python prepare_all.py --raw_dir "Dataset/dataverse_files" --out_dir preprocessing/data/processed --npoints 1024 --workers 8
```

* **ุชุดุบูู EDA (fast, processed mode):**

```bash
python eda.py --processed_dir preprocessing/data/processed/sampled --out_dir reports --fast
```

* **ุชุดุบูู EDA ุนูู raw data (full):**

```bash
python eda.py --raw_dir Dataset/dataverse_files --out_dir reports
```

* **ุนุฑุถ ุงู-notebook ุฃู ุชุตุฏูุฑ HTML (ูู ุฏุงุฎู ุงูุจูุฆุฉ):**

```bash
# ูู ุจุบูุชู ุชูููุฏ HTML ูุฏููุงู
jupyter nbconvert --to html reports/EDA_notebook.ipynb --output reports/index.html
```

---

## 6) ุงูุจุฑููุชุงุช (prompts) ุงููู ุงูุง ุณุจูุช ูุตุงูุจุชูููู ูููุญุฑูุฑ ุงููAI

ุงูููู ุฃูุง ููุช ุงููุตููู/ุงููุดุฑูุญ ูููprompts ุงููู ุฏูุฒุชู ููAI editor โ ุฃูุซูุฉ ููุฌุฒุฉ ุนูู ุงููู ุฏุฑูุงู (ุจุงุด ุชุจูู ุชููุงูู ุนูู ุงูุชุชุจูุน):

* Prompt ูุฅูุดุงุก `prepare_all.py` (A1): **ุชูุงุตูู ุดุงููุฉ** ููุฑุงุกุฉ ุตูุบ ูุชุนุฏุฏุฉุ SORุ centering, scalingุ normals, FPS (N=1024), multiprocessing, manifest CSVุ CLI argsุ deterministic behavior.
* Prompt ูุฅูุดุงุก `eda.py` (A2): **ุชูุงุตูู** ููุฑุงุกุฉ processed/rawุ ุญุณุงุจ ุฅุญุตุงุฆูุงุช (n\_points, bbox, centroid, density), ุตูุฑ ูุนุงููุฉ (Open3D fallback matplotlib), plots, CSV outputs, markdown report.
* Prompt ูุฅูุดุงุก `reports/EDA_notebook.ipynb` + export HTML: Notebook ุชูุงุนูู ูุนุฑุถ ุงููุชุงุฆุฌ ููุดุงุฑูุฉ ูุน ุงูุฃุณุชุงุฐ.

(ุฅุฐุง ุจุบูุชู ูุถููู ููุง ูุตูุต ุงููprompts ูุงููุฉ ุจุงุด ุชุฎุฒููู ูุงููrepoุ ููุฏุฑ ููุตููู ูู`docs/prompts.md`.)

---

## 7) ุงูููุงุนุฏ/ุงูุชุณูููุงุช ูุงููreproducibility ุงููู ุงุนุชูุฏูุงูุง ุงูููู

* **Config files / experiments:** ูู ุชุฌุฑุจุฉ ุบุงุฏู ุชุชุญุท `experiments/<method>/config.yaml` ูุน `seed` ูุทุฑู binarizationุ ุฅูุฎ (ุฎุงุตุฉ ููุง ูุจุฏุฃ ุงูุชุฏุฑูุจ).
* **Binarization requirement:** ุชุฐููุฑ ููู โ ุงูุฃุณุชุงุฐ ูุฑุถ BernoulliNB ูุงุญูุงู (model ููุงุณููู) ุงููู **ูุญุชุงุฌ features ุซูุงุฆูุฉ** โ ูุงุฒู ูุฎุฏู ูุฑุญูุฉ **binarization** ูููHu Moments ูุงููPCA features (ุงูุชุฑุงุญ: global median per feature ุนูู training set) ููุณุฌููู thresholds ูู`experiments/bernoulli/bin_thresholds.yaml`.
* **Logs & manifest:** manifest ุนูุฏู ูู path ูstatus ุจุงุด ูุฑุฌุนุฉ (audit) ูุณูู ุฅุนุงุฏุฉ ุชุดุบูู ุนูู ุนููุงุช ูุงูุตุฉ.

---

## 8) Action items / Next steps (ุดูู ูุฏูุฑู ุฏุงุจุง) โ ุชุฑุชูุจ ููุชุฑุญ

1. **A3 โ extract\_3d\_pca\_features.py** (ูููููู ุฏุงุจุง) โ ููู ูุฃู PointNet ูQuasi-direct methods ุบุงุฏู ูุญุชุงุฌู PCA-based descriptors. (ุฃูุง ููุฏุฑ ูููุฏ ุงูููุฏ ุฃู ุงู-prompt ุชูุง.)
2. **B1/B2 โ render\_views.py + extract\_2d\_hu.py** (ุนูุงุฏ ููุฏุฑ ูุจุฏุฃ ูู ูุงุฏ ุงูุฌุงูุจ):

   * ูุงุฒู ูุชููู ุนูู **render settings** (V=12 views, resolution=224ร224, camera distances, background color) ุจุงุด Hu Moments ุชููู ูุงุจูุฉ ููููุงุฑูุฉ.
3. **C1 โ train\_bernoulli\_nb.py**: ุจุนุฏ ุงุณุชุฎุฑุงุฌ Hu + PCA featuresุ ูุนูู binarization (global median) ููุฏุฑุจ `sklearn.naive_bayes.BernoulliNB`. ูุฎุฒู `bin_thresholds.yaml`.
4. **Evaluation scripts (D1)** โ `eval.py` ุจุงุด ูุฌูุน metrics (Accuracy, Balanced Accuracy, Macro F1, confusion matrix).
5. **ุชุญุถูุฑ ุงูุนุฑุถ (slides)** โ ูุฌุจุฏ ุฃูู ุงููplots & images ููุณููู ุงูุดุฑุญ ููุชูุฏูู.

---

## 9) ููุงุญุธุงุช ููุฒููู ุนูุงุฏ (to Imad)

* ุณููู ุนููู ๐
* ุฑุงูู ูููุช A1 ูA2 ุงููููุ ุงููุฎุฑุฌุงุช ููุฌูุฏุฉ ูู`preprocessing/data/processed/` ู`reports/`. ุดูู `reports/EDA_notebook.ipynb` ู`reports/index.html` ุจุงุด ุชุดูู ุงูููุฎูุต ู ุงูุตูุฑ โ ูุงุฏ ุงููnotebook ุชูุฏุฑ ุชุณุชุนููู ูุงูุนุฑุถ.
* **ุทูุจ ุตุบูุฑ:** ูุจู ูุง ุชุจุฏู ูู ุงุณุชุฎุฑุงุฌู Hu Moments (A2 โ B2)ุ ุนุทููู ุชุฃููุฏ ุนูู render settings ุงููู ุบุงุฏู ุชุณุชุฎุฏู ุจุงุด ูุจูู ููุญูุฏูู:

  * ุนุฏุฏ ุงูviews = 12 (ููุงูู)ุ
  * resolution = 224ร224ุ
  * background color = white / blackุ (ููุถูู **white** ุฃู alpha channel ุซู ูุณุชุฎุฑุฌ silhouette)
  * camera distance / focal length: ุงุณุชุนูู ููุณ ุงูparameters ููู sample (ููุฏุฑ ูุนุทูู default values).
* ุฅูู ููุชู OK ุนูู ูุงุฏ ุงูุฅุนุฏุงุฏุงุช ููููุฏ ูู `render_views.py` ู`extract_2d_hu.py` prompts/code.

---

## 10) ุฎุงุชูุฉ (short)

ุฎุฏููุง ุงูููู ุฅุนุฏุงุฏ ููู ููุชูู: preprocessing reliable ู EDA ูุตููุฑ ููุตุฏูุฑ HTML. ูููู ููุชุงููู ููููููู ูุจุงุดุฑุฉ ูุงุณุชุฎุฑุงุฌ ุงููPCA features (A3) ููุง ุชูุถู ุชูููู ุชูููู Imad ูุฎุฏู ุนูู rendering ูHu Momentsุ ูููู ุดูู ุชุฎุชุงุฑ ูุฃูุง ููููุฏ ูู ุงูุณูุฑูุจุช/ุงููprompt ูุงูุญุงู.

ุฅุฐุง ุจุบูุช ูุฏุฑุฌ ูุงุฏ ุงูุชูุฑูุฑ ูู`reports/daily_2025-08-25.md` ููุง ูู`src/notes/today_report_2025-08-25.md` ููุฏุฑ ููููุฏู ููู ููุฑุงู ุจุงุด ุชูุตููู ูุงููrepo. ุจุบูุชูู ูุญุทูู ูููุ
